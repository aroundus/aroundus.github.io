{
    "componentChunkName": "component---src-components-template-post-template-tsx",
    "path": "/post/aws/awscli/",
    "result": {"data":{"site":{"siteMetadata":{"title":"AROUNDUS"}},"markdownRemark":{"id":"b8b0e0ea-840b-567e-ad21-5eabde40eec2","fields":{"slug":"/post/aws/awscli/"},"html":"<p><strong>AWS 커맨드 라인 인터페이스</strong>(AWS CLI, AWS Command Line Interface)는 AWS 서비스를 관리하는 통합 도구로 여러 AWS 서비스를 명령줄에서 제어합니다. 주로 자동화 처리 목적으로 사용합니다.</p>\n<h2 id=\"Install\" style=\"position:relative;\">Install<a href=\"#Install\" aria-label=\"Install permalink\" class=\"icon-heading-link after\"><svg viewBox=\"0 0 24 24\" height=\"24\" aria-hidden=\"true\"><path d=\"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z\"></path></svg></a></h2>\n<p><code>brew</code> 명령어로 설치하는 것을 권장합니다.</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"59817285124895550000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"코드 내용을 복사하였습니다.\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`brew install awscli // AWS CLI\nbrew install jq     // JSON processor`, `59817285124895550000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                <svg viewBox=\"0 0 24 24\"><path d=\"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z\"></path></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">brew <span class=\"token function\">install</span> awscli // AWS CLI\nbrew <span class=\"token function\">install</span> jq     // JSON processor</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h2 id=\"Configure\" style=\"position:relative;\">Configure<a href=\"#Configure\" aria-label=\"Configure permalink\" class=\"icon-heading-link after\"><svg viewBox=\"0 0 24 24\" height=\"24\" aria-hidden=\"true\"><path d=\"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z\"></path></svg></a></h2>\n<p>AWS 서비스를 사용하기 위하여 <a href=\"https://console.aws.amazon.com/iam/home\">IAM</a>에 사용자 정보를 등록합니다. (개별 IAM 사용자 생성 - 사용자 관리 - 사용자 추가) 등록을 완료하면 credentials 정보가 나옵니다. 해당 정보는 한 번 확인하면 새로 고침 시 재확인이 불가하기 때문에 꼭 파일로 저장해 두어야 합니다.</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"26266529653847437000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"코드 내용을 복사하였습니다.\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`aws configure`, `26266529653847437000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                <svg viewBox=\"0 0 24 24\"><path d=\"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z\"></path></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">aws configure</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"25367529454413340000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"코드 내용을 복사하였습니다.\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`AWS Access Key ID [None]: AKI***\nAWS Secret Access Key [None]: ***\nDefault region name [None]: ap-northeast-2\nDefault output format [None]:`, `25367529454413340000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                <svg viewBox=\"0 0 24 24\"><path d=\"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z\"></path></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">AWS Access Key ID <span class=\"token punctuation\">[</span>None<span class=\"token punctuation\">]</span>: AKI***\nAWS Secret Access Key <span class=\"token punctuation\">[</span>None<span class=\"token punctuation\">]</span>: ***\nDefault region name <span class=\"token punctuation\">[</span>None<span class=\"token punctuation\">]</span>: ap-northeast-2\nDefault output <span class=\"token function\">format</span> <span class=\"token punctuation\">[</span>None<span class=\"token punctuation\">]</span>:</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>사용자 정보 입력 후 엔터를 계속 입력하여 설정을 완료합니다. 해당 설정은 <code>~/.aws/</code> 폴더에 파일로 저장됩니다.</p>\n<h2 id=\"Commands\" style=\"position:relative;\">Commands<a href=\"#Commands\" aria-label=\"Commands permalink\" class=\"icon-heading-link after\"><svg viewBox=\"0 0 24 24\" height=\"24\" aria-hidden=\"true\"><path d=\"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z\"></path></svg></a></h2>\n<p><a href=\"https://docs.aws.amazon.com/cli/latest/reference/\">Reference</a> 참조</p>\n<h3 id=\"ec2\" style=\"position:relative;\">ec2<a href=\"#ec2\" aria-label=\"ec2 permalink\" class=\"icon-heading-link after\"><svg viewBox=\"0 0 24 24\" height=\"24\" aria-hidden=\"true\"><path d=\"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z\"></path></svg></a></h3>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"144779848090093020\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"코드 내용을 복사하였습니다.\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`aws ec2 describe-instances`, `144779848090093020`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                <svg viewBox=\"0 0 24 24\"><path d=\"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z\"></path></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">aws ec2 describe-instances</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h2 id=\"Scripts\" style=\"position:relative;\">Scripts<a href=\"#Scripts\" aria-label=\"Scripts permalink\" class=\"icon-heading-link after\"><svg viewBox=\"0 0 24 24\" height=\"24\" aria-hidden=\"true\"><path d=\"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z\"></path></svg></a></h2>\n<h3 id=\"Security-Group\" style=\"position:relative;\">Security Group<a href=\"#Security-Group\" aria-label=\"Security Group permalink\" class=\"icon-heading-link after\"><svg viewBox=\"0 0 24 24\" height=\"24\" aria-hidden=\"true\"><path d=\"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z\"></path></svg></a></h3>\n<p>필자가 작업하는 사무실은 유동 IP를 사용하여 매일 새 IP를 할당합니다. 새 IP를 할당하면 이전 IP로 서버 접속이 불가하여 AWS에서 보안 그룹의 사무실 IP 정보를 수정해야 합니다.</p>\n<p>서버에 문제가 발생하였는데 그 사이에 IP가 바뀌면서 서버 접속이 불가하면 굉장히 난감한 상황이 됩니다. AWS에 접속하여 보안 그룹을 수정해야 하는데 복잡하기로 유명한 AWS 인터페이스 안에서 버벅이다가 작업이 늦춰질 수 있습니다.</p>\n<p>다음 스크립트를 실행하면 설명과 일치하는 이전 IP 목록을 삭제한 후 새 IP를 추가할 수 있습니다.</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"53888032275802500000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"코드 내용을 복사하였습니다.\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`MY_IP=\\$(curl -s https://checkip.amazonaws.com)\n\nrun() {\n    echo &quot;describe-security-groups \\$1&quot;\n    REMOTE_IP_LIST=\\$(aws ec2 describe-security-groups --group-id \\$1 | jq '.SecurityGroups[0].IpPermissions['\\$2'].IpRanges[] | select(.Description == &quot;DUNAMU Office&quot;) | .CidrIp' -r)\n\n    for REMOTE_IP in \\$REMOTE_IP_LIST\n    do\n        echo &quot;revoke-security-group-ingress \\$REMOTE_IP&quot;\n        aws ec2 revoke-security-group-ingress --group-id \\$1 --protocol tcp --port 0-65535 --cidr \\$REMOTE_IP\n    done\n\n    echo &quot;authorize-security-group-ingress \\$MY_IP&quot;\n    aws ec2 authorize-security-group-ingress --group-id \\$1 --ip-permissions IpProtocol=tcp,FromPort=0,ToPort=65535,IpRanges='[{CidrIp='\\$MY_IP'/32,Description=&quot;DUNAMU Office&quot;}]'\n    echo &quot;\\n&quot;\n}\n\nrun sg-***************** 1\nrun sg-***************** 1\nrun sg-***************** 0`, `53888032275802500000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                <svg viewBox=\"0 0 24 24\"><path d=\"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z\"></path></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token assign-left variable\">MY_IP</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">curl</span> -s https://checkip.amazonaws.com<span class=\"token variable\">)</span></span>\n\n<span class=\"token function-name function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"describe-security-groups <span class=\"token variable\">$1</span>\"</span>\n    <span class=\"token assign-left variable\">REMOTE_IP_LIST</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span>aws ec2 describe-security-groups --group-id $1 <span class=\"token operator\">|</span> jq <span class=\"token string\">'.SecurityGroups[0].IpPermissions['</span>$2<span class=\"token string\">'].IpRanges[] | select(.Description == \"DUNAMU Office\") | .CidrIp'</span> -r<span class=\"token variable\">)</span></span>\n\n    <span class=\"token keyword\">for</span> <span class=\"token for-or-select variable\">REMOTE_IP</span> <span class=\"token keyword\">in</span> <span class=\"token variable\">$REMOTE_IP_LIST</span>\n    <span class=\"token keyword\">do</span>\n        <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"revoke-security-group-ingress <span class=\"token variable\">$REMOTE_IP</span>\"</span>\n        aws ec2 revoke-security-group-ingress --group-id <span class=\"token variable\">$1</span> --protocol tcp --port <span class=\"token number\">0</span>-65535 --cidr <span class=\"token variable\">$REMOTE_IP</span>\n    <span class=\"token keyword\">done</span>\n\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"authorize-security-group-ingress <span class=\"token variable\">$MY_IP</span>\"</span>\n    aws ec2 authorize-security-group-ingress --group-id <span class=\"token variable\">$1</span> --ip-permissions <span class=\"token assign-left variable\">IpProtocol</span><span class=\"token operator\">=</span>tcp,FromPort<span class=\"token operator\">=</span><span class=\"token number\">0</span>,ToPort<span class=\"token operator\">=</span><span class=\"token number\">65535</span>,IpRanges<span class=\"token operator\">=</span><span class=\"token string\">'[{CidrIp='</span><span class=\"token variable\">$MY_IP</span><span class=\"token string\">'/32,Description=\"DUNAMU Office\"}]'</span>\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"<span class=\"token entity\" title=\"\\n\">\\n</span>\"</span>\n<span class=\"token punctuation\">}</span>\n\nrun sg-***************** <span class=\"token number\">1</span>\nrun sg-***************** <span class=\"token number\">1</span>\nrun sg-***************** <span class=\"token number\">0</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","tableOfContents":"<ul>\n<li><a href=\"#install\">Install</a></li>\n<li><a href=\"#configure\">Configure</a></li>\n<li><a href=\"#commands\">Commands</a></li>\n<li><a href=\"#scripts\">Scripts</a></li>\n</ul>","frontmatter":{"category":"aws","index":1,"title":"AWS 커맨드 라인 인터페이스","description":"보안 그룹 하나만 수정하면 되는데 AWS 웹 인터페이스 안에서 시간을 낭비한 경험이 있으신가요? 이제 터미널에서 AWS 웹과 동일한 기능을 구현하는 명령을 실행하세요.","image":null,"date":"2020-05-17"}},"prevPost":{"fields":{"slug":"/post/jekyll/theme/"},"frontmatter":{"category":"jekyll","title":"테마 적용하기"}},"nextPost":{"fields":{"slug":"/post/aws/iam/"},"frontmatter":{"category":"aws","title":"IAM"}}},"pageContext":{"id":"b8b0e0ea-840b-567e-ad21-5eabde40eec2","prevPostID":"753474ee-204c-51b1-9c40-d1c1b4dfdfe4","nextPostID":"c178697f-dde4-5851-b5e4-71edb386030e"}},
    "staticQueryHashes": ["1955143157","2731891648"]}